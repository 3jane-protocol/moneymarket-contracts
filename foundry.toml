[profile.default]
libs = ["lib"]
names = true
sizes = true
via_ir = true
optimizer = true
optimizer_runs = 999999
bytecode_hash = "none"
cbor_metadata = false
solc = "0.8.22"
evm_version = "shanghai"

[profile.default.invariant]
runs = 16
depth = 256
fail_on_revert = true

[profile.default.fmt]
wrap_comments = true

[profile.build]
test = "/dev/null"
script = "/dev/null"

[profile.script]
test = "/dev/null"
ffi = true
ast = true
fs_permissions = [
  { access = "read-write", path = "./deployments" },
  { access = "read-write", path = "./out" },
  { access = "read-write", path = "./data" },
  { access = "read-write", path = "." },
  { access = "read", path = "/tmp" },
]
build_info = true
extra_output = ["storageLayout"]

[profile.test]
via-ir = false
script = "/dev/null"
# Run all tests but exclude IRM tests
no_match_path = "**/{irm,production}/**"

[profile.test-irm]
# IRM tests need via-ir due to stack complexity
via-ir = true
script = "/dev/null"
optimizer_details.optimizerSteps = "u"
# Only run IRM tests
match_path = "**/irm/**"

[profile.halmos]
# IRM tests need via-ir due to stack complexity
via-ir = false
script = "/dev/null"
test = "test/halmos"


[profile.fork]
# Fork tests configuration
test = "test/forge/usd3/fork"
via_ir = false
fork_block_number = 23400200  # Fixed block for reproducibility

[profile.production-test]
# Optimized profile for production testing with minimal compilation
src = "test/forge/production"
test = "test/forge/production"
script = "/dev/null"
via_ir = false
optimizer = true
optimizer_runs = 200
ffi = true
# Skip unnecessary compilation
match_path = "test/forge/production/*"


# See more config options https://github.com/foundry-rs/foundry/tree/master/crates/config
